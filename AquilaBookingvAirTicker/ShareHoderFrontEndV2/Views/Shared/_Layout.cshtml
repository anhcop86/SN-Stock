@using System.Globalization;
@using System.Threading;

<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="../../images/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    @{
                 
                   System.Globalization.CultureInfo currentCulture = Thread.CurrentThread.CurrentCulture;
                   if (currentCulture.Name == "vi-VN")  {
                        <meta http-equiv="content-language" content="vi" />
                   }else{
                       <meta http-equiv="content-language" content="en" />
                   }
     }
     
    <title>@ViewBag.Title</title>
    <link rel="stylesheet" type="text/css" href="../../Content/style.css" />
    <link rel="stylesheet" type="text/css" href="../../Content/SpryTabbedPanels.css" />
     <script type="text/javascript" src="../../Scripts/SpryTabbedPanels.js"></script>
     <script type="text/javascript" src="../../Scripts/jquery.min.js"></script>
     <script type="text/javascript" src="../../Scripts/jquery.unobtrusive-ajax.min.js"></script>
@*    <script src="../../Scripts/jquery-1.9.1.js" type="text/javascript"></script>*@
    <script src="../../Scripts/jquery-ui.js" type="text/javascript"></script>
    <link href="../../Content/jquery-ui.css" rel="stylesheet" type="text/css" />
    <script src="../../Scripts/account.js" type="text/javascript"></script>
     <link rel="stylesheet" href="../../Content/dropkick.css" />
		    <script src="../../Scripts/dropkick.js" type="text/javascript" charset="utf-8"></script>
		    <script type="text/javascript">
		        $(function () {
		            $('.select1').dropkick();
		            $('.select2').dropkick();
		            $('.select3').dropkick();
		            $('.select4').dropkick();
		            $('.select5').dropkick();
		            $('.select6').dropkick();
		        });
    </script>
    <link rel="stylesheet" href="../../Content/fade-plugin.css" />
     <script type="text/javascript" src="../../Scripts/fade-plugin.js"></script>
        <script type="text/javascript">
            (function ($) {
                function init() {

                    $("#example1 .effectContainer").fadeTransition({ pauseTime: 2000,
                        transitionTime: 1000,
                        ignore: "#introslide",
                        delayStart: 2000,
                        pauseOnMouseOver: true,
                        createNavButtons: true
                    });

                    var example3 = $("#example3 .effectContainer").fadeTransition().fader();
                    $("#back").click(function (e) { example3.prev(); e.preventDefault(); });
                    $("#next").click(function (e) { example3.next(); e.preventDefault(); });
                }


                $(document).ready(init);
                $(document).click(function (e) {
                    var myID = e.target.id;
                    if (myID !== 'selectLanguage') {
                        hideLanguageBox();
                    }
                });
            })(jQuery);
        </script>
</head>
<body>
	<div class="main">
		<div class="header">
			<div class="logo"><a href="/Home"><img src="../../images/logo.jpg" alt="Aquila logo" title="Aquila Booking" /></a></div>
            
         @*    @{
                  if(Session["LoginByFacebook"] == null)
                    {Session["LoginByFacebook"] = "";}
                  if (User.Identity.IsAuthenticated && Session["LoginByFacebook"] == "Y")
                  {
                     @: <div style=""> <fb:login-button show-faces="true" width="200" max-rows="1" onlogin="afterFacebookConnect();"></fb:login-button></div>
                  }
               }*@
			<div class="right-header">
				<div class="top-hea">
                 @Html.ActionLink(@Resources.Resource.shoppingCart, "Index", "ShoppingCart", null, new { @class = "cart" })
            
               @{
                   if (!User.Identity.IsAuthenticated)
                   {
                       @: @Html.ActionLink(@Resources.Resource.logOn, "Logon", "Account", null, new { @class = "login" })
                        @Html.ActionLink(@Resources.Resource.signUp, "Register", "Account", null, new { @class = "signup" })                       
                   }
                   else
                   {
                       ShareHolderCore.Domain.Model.Membership mem= (@Session["LoginObject"] as ShareHolderCore.Domain.Model.Membership);
                       String MemberName;
                       if(mem != null){
                            MemberName = (@Session["LoginObject"] as ShareHolderCore.Domain.Model.Membership).MemberName;
                            
                       }else
                       {
                           
                                string test = User.Identity.Name;
                                ShareHolderCore.IMembershipRepository<ShareHolderCore.Domain.Model.Membership> userRep = new ShareHolderCore.Domain.Repositories.MembershipRepository();
                                ShareHolderCore.Domain.Model.Membership membership = null;
                                
                                membership = userRep.GetByLoginId(User.Identity.Name);
                                Session["LoginObject"] = membership;
                                MemberName = (@Session["LoginObject"] as ShareHolderCore.Domain.Model.Membership).MemberName;
                        
                       }
                       @Html.ActionLink(MemberName, "MyProfile", "Account", null, new { @class = "signup" })
                       @: @Html.ActionLink("Logout", "LogOff", "Account", null, new { @class = "logout", onclick = "logoutFacebook();" })
                   }
               } 
               @{
                   if (currentCulture.Name == "en-US")
                   {
                        @:<a href="#" class="langue" onclick="displayLanguageBox()"  id="selectLanguage">@Resources.Resource.LangE</a>
                   }
                   else
                   {
                        @:<a href="#" class="langue" onclick="displayLanguageBox()"  id="selectLanguage">@Resources.Resource.LangV</a>
                   }        
                }             
				
                <div  class="languageBox" id="languageBox">
                    <ul>
                        <li><a href="/Home/ChangeCurrentCulture/0"   class="langue1">Tiếng việt</a></li>
                        <li><a href="/Home/ChangeCurrentCulture/1"   class="langue1">English</a></li>
                    </ul>
                </div>
                
			</div><!--top-hea-->
				<div class="clear"></div>
			        <ul class="menu-hea">                
				        <!--<li >@Html.ActionLink("Vé máy bay", "Index", "AirTicket", null, new { id = "AirTicketId" })</li>-->
				        <li>@Html.ActionLink(@Resources.Resource.dometicHotel, "index", "Home", null, new { id = "HotelBookingId" })</li>
                        <li><a href="http://www.vemaybaysieure.vn/" target="_blank"> @Resources.Resource.airticket</a></li>
                        <li><a href="@Url.Action("Index", "BookingHistory")"> @Resources.Resource.ShortCheckingHotelBooking</a></li>
                        @*<li>@Html.ActionLink(@Resources.Resource.payment, "PaymentInfo", "Home", null, new { id = "PaymentInfoId" })</li>*@                   
				    </ul>               
			</div><!--right-header-->            
			<div class="box-social">          
			<div class="box-fac">
				<div class="fb-like" data-href="test.aquila.com.vn" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true"></div><br />
                @*<div class="fb-like" data-href="https://developers.facebook.com/docs/plugins/" data-layout="standard" data-action="like" data-show-faces="true" data-share="true"></div>*@
			</div>
			@*<div class="box-like">
			<img src="../../images/hinh-like.jpg" />
			</div>*@
			</div><!--box-social-->
		</div><!--header-->
          <div class="widthFull">
                
                @{
                    if (Session["textboxSeachValue"] != null && Session["textboxSeachValue"].ToString() != "")
                    {
                        IList<String> locationTag = ShareHoderFrontEndV2.Ext.ApplicationHelper.LocationTag();
                        int lenoflocationTag = locationTag.Count;
                        int i = 0;
                        foreach (var item in locationTag)
                        {
                            i += 1;
                             @Html.ActionLink(@item, "Index", "DestinationSearchResult", new { searchInput = @item, FavouritDestination = Path.GetRandomFileName().Replace(".", "") }, null)
                     
                            @: &nbsp;&nbsp; 
                            if (lenoflocationTag != i)
                            {
		                            @: >
	                        }
                        }
                    }
                }
            </div>
		@*<div class="nav">
			<ul>
                <b>
			        <li>@Html.ActionLink("Đặt Vé máy bay", "Index", "AirTicket")</li>
			        <li>@Html.ActionLink("So Sánh", "Index", "CompareList")</li>
			        <li><a href="#">Phân Tích</a></li>
			        <li><a href="#"></a></li>
                </b>
			</ul>
		</div>*@<!--nav-->		
        <!--Content body-->
		@RenderBody()
        <!--End content body-->
		<div class="footer">
	        <li>
	            <a href="/Home/About">@Resources.Resource.About</a>
	            <a href="http://www.vemaybaysieure.vn/" target="_blank">@Resources.Resource.purchaseAirTicket</a>	                           
	        </li>
	        <li>
	            <a href="/Home/terms">@Resources.Resource.termOfUse</a>
	            <a href="#">@Resources.Resource.howToPay</a>	            
	        </li>	       
	        <li class="addres" style="margin-right:5px;margin-left:10px">               
                <b>Sigma Booking: Dịch vụ đặt phòng, vé máy bay</b><br/>                             
                131 Tây Thạnh, phường Tây Thạnh Quận Tân Phú, Tp.Hồ Chí Minh<br />
                <b>Điện thoại:</b> 08.3602.7684 – 3602.7685 <b>Hotlines:</b> 094.909.0818 – 090.251.4439<br />
	            <b>Email:</b> booking@sigmabooking.com<br />
                 <b>Công ty TNHH công nghệ Aquila</b> lầu 1, tòa nhà PVFCCo, 43 Mạc Đĩnh Chi, Quận 1, Tp.Hồ Chí Minh<br />
	        </li>
           
	    </div><!--footer-->

	</div><!--main-->

<div id="fb-root"></div>
<script type="text/javascript">   

 (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/vi_VN/all.js#xfbml=1&appId=177681019090583";
        fjs.parentNode.insertBefore(js, fjs);
    } (document, 'script', 'facebook-jssdk'));
    
    </script>
</body>
</html>
<script type="text/javascript">
    $(document).ready(function () {
        var path = window.location.pathname;
        if (path.indexOf("AirTicket") != -1) {
            $('#AirTicketId').attr("style", "background-color:#58A0AF");
        } else if (path.indexOf("PaymentInfo") != -1) {
            $('#PaymentInfoId').attr("style", "background-color:#58A0AF");
        }
        else {

            $('#HotelBookingId').attr("style", "background-color:#58A0AF");
        }
    });
</script>
<script type="text/javascript">
      <script >
          window.fbAsyncInit = function () {
              FB.init({
                  appId: '177681019090583',
                  status: true, // check login status
                  cookie: true, // enable cookies to allow the server to access the session
                  xfbml: true  // parse XFBML
              });

              // Here we subscribe to the auth.authResponseChange JavaScript event. This event is fired
              // for any authentication related change, such as login, logout or session refresh. This means that
              // whenever someone who was previously logged out tries to log in again, the correct case below 
              // will be handled. 
              FB.Event.subscribe('auth.authResponseChange', function (response) {
                  // Here we specify what we do with the response anytime this event occurs. 
                  if (response.status === 'connected') {
                      // The response object is returned with a status field that lets the app know the current
                      // login status of the person. In this case, we're handling the situation where they 
                      // have logged in to the app.
                      var uid = response.authResponse.userID;
                      var accessToken = response.authResponse.accessToken;
                      
//                      testAPI(accessToken);
                  } else if (response.status === 'not_authorized') {
                      // In this case, the person is logged into Facebook, but not into the app, so we call
                      // FB.login() to prompt them to do so. 
                      // In real-life usage, you wouldn't want to immediately prompt someone to login 
                      // like this, for two reasons:
                      // (1) JavaScript created popup windows are blocked by most browsers unless they 
                      // result from direct interaction from people using the app (such as a mouse click)
                      // (2) it is a bad experience to be continually prompted to login upon page load.
                      FB.login();
                  } else {
                      // In this case, the person is not logged into Facebook, so we call the login() 
                      // function to prompt them to do so. Note that at this stage there is no indication
                      // of whether they are logged into the app. If they aren't then they'll see the Login
                      // dialog right after they log in to Facebook. 
                      // The same caveats as above apply to the FB.login() call here.
                      FB.login();
                  }
              });
          };

          // Load the SDK asynchronously
          (function (d) {
              var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
              if (d.getElementById(id)) { return; }
              js = d.createElement('script'); js.id = id; js.async = true;
              js.src = "//connect.facebook.net/en_US/all.js";
              ref.parentNode.insertBefore(js, ref);
          } (document));

          // Here we run a very simple test of the Graph API after login is successful. 
          // This testAPI() function is only called in those cases. 
          function testAPI(accessToken) {
              console.log('Welcome!  Fetching your information.... ');
              FB.api('/me', function (response) {
                  console.log('Good to see you, ' + response.name + '.');
                  
              });
          }
          function logoutFacebook() {
              FB.logout(function (response) {
//            alert('Đã logout khỏi facebook');
              });
          }
</script>
<script type="text/javascript">

    function displayLanguageBox() {
        var offset = $("#selectLanguage").offset();
        var top = offset.top;
        var left = offset.left;
        var right = $("#selectLanguage").offset().left + $("#selectLanguage").width();
        var r2 = $("#selectLanguage").width();      
        $("#languageBox").css('top', 25);
        $("#languageBox").css('left', left);
        $("#languageBox").show();
    }

    function hideLanguageBox() {        
        $("#languageBox").hide();
    }
</script>
<!--
  Below we include the Login Button social plugin. This button uses the JavaScript SDK to
  present a graphical Login button that triggers the FB.login() function when clicked. -->



