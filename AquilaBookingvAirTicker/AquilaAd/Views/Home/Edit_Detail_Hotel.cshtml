@model AquilaAd.Models.HotelModel
@{
    ViewBag.Title = "Chi tiết khách sạn";
}

<link href="../../styles/jquery-ui.css" rel="stylesheet" type="text/css" />
<script src="../../Scripts/jquery-ui.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.form.js" type="text/javascript"></script>

<div id="content">

            <h2><span>Khách sạn : Cập nhật</span></h2>

            <!-- tab -->
         @*   <ul id="tab">
                <li><a href="#" title="Property 100 (rows)">Property 100 (rows)</a></li>
                <li class="Active">
                    <span>New property</span>
                    <a href="#" title="Close" class="Close">Close</a>
                </li>
            </ul>*@
            <!-- tab.end -->

            <!-- panel -->
            <div class="Panel">

                <!-- functions -->
                <ul class="Functions">
                    <li><a href="#" id="submit_link">Save</a>
                    @*<li>@Html.ActionLink("Save", "Save", "Home", new { actionpage = "Save", idhotel = "" }, null)</li>*@
                    <li>@Html.ActionLink("Save & New", "Save", "Home", new { actionpage = "SaveNew", idhotel = "" }, null)</li>
                    <li>@Html.ActionLink("Cancel", "CancelHotel", "Home", new { actionpage = "Cancel", idhotel = "" }, null)</li>
                    <li>
                        <span>Actions</span>
                        <ul>
                            <li><a href="#" title="Approve property">Approve property</a></li>
                            <li><a href="#" title="View facilities">View facilities</a></li>
                            <li>
                                <span>Translation</span>
                                <ul>
                                    <li><a href="#" title="Tiếng Việt">Tiếng Việt</a></li>
                                    <li><a href="#" title="French">French</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <!-- functions.end -->

            </div>
            <!-- panel.end -->

            <!-- subtab -->
          <div id="tabs">
              <ul>
                <li><a href="#tabs-1">Thông tin khách sạn</a></li>
                <li><a href="#tabs-2">Hình khách sạn</a></li>
                <li><a href="#tabs-3">Dịch vụ</a></li>
              </ul>
              <div id="tabs-1">
                <div id="mainContent">
             @using (Html.BeginForm("SaveEdit", "Home", FormMethod.Post, new { id = "Submitform" }))
             {
                 @Html.ValidationSummary()
                <fieldset>
                 <div>                     
                     <input type="hidden" value="@Model.HotelId" id="GetHotelId" name="GetHotelId" />  
                    </div>
                    <div class="Input">
                        <label for="code">Tên khách sạn:</label>
                        @*<input type="text" id="HotelName" name="HotelName" class="Medium" required />*@
                        @Html.TextBoxFor(m => m.Name, new { id = "HotelName", name = "HotelName", @class = "Large" })
                        @Html.ValidationMessageFor(m => m.Name)
                        
                        <span class="Required">*</span>
                    </div>
                    <div class="Input">
                        <label for="description">Địa chỉ:</label>                        
                        @Html.TextBoxFor(m => m.HotelAddress, new { id = "HotelAddress", style = "width:450px", @class = "Large" })
                    </div>
                    <div class="Input">
                        <label for="unit">Xếp hạng sao:</label>
                        
                        @Html.DropDownListFor(m => m.Star, ViewBag.StarHotel as SelectList, " ", new { id = "unitStar", @class = "Small" })
                       
                    </div>
                    <div class="Input">
                        <label for="mediumDescription">Medium description:</label>                                                
                        @Html.TextAreaFor(m => m.ShortDesc, new { id = "mediumDescription", name = "mediumDescription", rows = "10", cols = "10", style = "width:450px;height:100px", placeholder = "Nhập miêu tả ngắn gọn" }) 
                    </div>
                    <div class="editor-field">
                        <label for="longDescription"><b>Long description:</b></label>
                            @Html.TextAreaFor(m => m.LongDesc, new { @class = "ckeditor", @id = "cke_editor12" })
                                                 

                    </div>
                     <div class="Input">
                        <label for="description">Location tag search:</label>                        
                        @Html.TextBoxFor(m => m.Location, new { id = "LocationTagSearch", style = "width:450px", name = "LocationTagSearch", @class = "Large" }) 
                    </div>
                      <div class="Input">
                        <label for="unit">Khu vực:</label>
                       
                        @Html.DropDownListFor(m => m.ProvinceId, (SelectList)ViewBag.listAllProvince, " ", new { id = "ProviceHotel", @class = "Medium" })
                    </div>
                    <div class="Input">
                        <label for="unit">Khách sạn được ưa chuộng:</label>                      
                        @Html.DropDownListFor(m => m.MostView, ViewBag.MostViewHotel as SelectList, " ", new { id = "MostView", @class = "Small" })
                        
                    </div>

                    <div class="editor-field">
                        <label for="longDescription"><b>Điều kiện đặt phòng:</b></label>
                            @Html.TextAreaFor(m => m.BookingCondition, new { @class = "ckeditor", @id = "cke_editor12" })      

                    </div>

                     <div class="Input">
                        <label for="unit">Hiển thị:</label>                      
                        @Html.DropDownListFor(m => m.Display, ViewBag.DislayConditon as SelectList, " ", new { id = "Display-BookingCondition", @class = "Small" })
                        
                    </div>

                    <div class="Input">
                        <label for="price">Ngày tạo:</label>
                        <input type="date" id="CreatedDate" name="CreatedDate" class="Medium" value="@ViewData["createdDate"].ToString()" />
                        
                    </div>
                    <div class="Input">
                        <label for="code">Người tạo:</label>                        
                         @Html.TextBoxFor(m => m.CreatedBy, new { id = "CreatedBy", name = "CreatedBy", @class = "Medium" })
                    </div>                     
                         <div class="Input">
                        <label for="unit">Tài khoản quản lý:</label>
                       @{
                        if (User.Identity.IsAuthenticated && (@Session["UserType"] as ShareHolderCore.Domain.Model.HotelOwner) != null)
                         {
                             @: @Html.DropDownList("SelectHotelOwner", (SelectList)ViewBag.listHotelOwner, " ", new { id = "ProviceHotel", @class = "Medium", disabled = "disabled" })
                         }
                         else
                         {
                             @: @Html.DropDownList("SelectHotelOwner", (SelectList)ViewBag.listHotelOwner, " ", new { id = "ProviceHotel", @class = "Medium" })
                         }
                        }
                        
                    </div>
                    @*<input type="submit" value="sumit" id="submittest" style="background:none"/>*@
                </fieldset>                 
             }
                
            </div>
              </div>
              <div id="tabs-2">
              <div>
                <div>
                @using (Html.BeginForm("UploadImage", "Home", FormMethod.Post, new { id = "SubmitformUploadImage", enctype = "multipart/form-data" })) // upload hình phải có thuộc tính này, enctype = "multipart/form-data"
                {
               
                    <input type="hidden" value="@Model.HotelId" id="GetHotelIdUploadImage" name="GetHotelIdUploadImage" />  
                    <div style="float:left">

                        @Html.DropDownList("SelectRoomType", (SelectList)ViewBag.listRoomType, "Chọn phòng", new { id = "SelectRoomType", @class = "Nomal", onchange = "LoadImage(this.value)" })

                        <input type="file" id="uploadfileid" name="uploadfileid" />
                    </div>
                    <div style="float:right; padding:.5em 1em;text-decoration:none;  font-weight:bold">                        
                        <a href="#" id="deleteImageLink" style = "color:#1c94c4" >Delete</a>
                        <a href="#" id="submit_linkUploadImage" style = "color:#1c94c4" >Upload</a>
                       
                    </div>
                   
                }
                     </div>
                 </div>
                 <br /><br />
                  <div  id="divDocument" style=""></div>
              </div>
              <div id="tabs-3">
                    <div id="mainContent">
                               <div class="Table">
                                    <table cellpadding="0" cellspacing="0">
                                        <thead>
                                            <tr>
                                                <th>Chọn</th>
                                    
                                                <th>Tên dịch vụ</th>
                                  
                                               
                                            </tr>
                                        </thead>
                                        <tbody>
                                        @foreach (var item in (IList<ShareHolderCore.Domain.Model.FacilityExtent>)ViewData["servicesOfHotel"])
                                        {                                
                           
                                            <tr>
                                                <td>
                                                    <input type="checkbox" class="Checkbox" id="checkBoxUpdateFacility" name="checkBoxUpdateFacility" value="@item.FacilityId"
                                                        @{ 
                                            if (item.CheckFacility == "Y")
                                            {
                                                                @:checked="checked"
                                                            }
                                                      
                                                         }
                                                   @* // dich vu duoc chọn*@
                                                     />
                                                 </td>                                    
                                    
                                                <td class="Desc" style="text-align:center">
                                                    <h3>@item.Name</h3>                                                                               
                                                </td>                                                                
                                                
                                            </tr>
                                        }
                              
                                        </tbody>
                                    </table>
                            </div>
                        </div>
              </div>
         @*     <div id="tabs-3">
                <p>Mauris eleifend est et turpis. Duis id erat. Suspendisse potenti. Aliquam vulputate, pede vel vehicula accumsan, mi neque rutrum erat, eu congue orci lorem eget lorem. Vestibulum non ante. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Fusce sodales. Quisque eu urna vel enim commodo pellentesque. Praesent eu risus hendrerit ligula tempus pretium. Curabitur lorem enim, pretium nec, feugiat nec, luctus a, lacus.</p>
                <p>Duis cursus. Maecenas ligula eros, blandit nec, pharetra at, semper at, magna. Nullam ac lacus. Nulla facilisi. Praesent viverra justo vitae neque. Praesent blandit adipiscing velit. Suspendisse potenti. Donec mattis, pede vel pharetra blandit, magna ligula faucibus eros, id euismod lacus dolor eget odio. Nam scelerisque. Donec non libero sed nulla mattis commodo. Ut sagittis. Donec nisi lectus, feugiat porttitor, tempor ac, tempor vitae, pede. Aenean vehicula velit eu tellus interdum rutrum. Maecenas commodo. Pellentesque nec elit. Fusce in lacus. Vivamus a libero vitae lectus hendrerit hendrerit.</p>
              </div>*@
            </div>
            <!-- subtab.end -->

            <!-- mainContent -->
            
            
            <!-- mainContent.end -->

            <!-- panel -->
            <div class="Panel">

                <!-- functions -->
                <ul class="Functions">
                    <li><a href="#" id="submit_link">Save</a>
                        
                    </li>
                    <li>@Html.ActionLink("Save & New", "Save", "Home", new { actionpage = "SaveNew", idhotel = "" }, null)</li>
                    <li>@Html.ActionLink("Cancel", "CancelHotel", "Home")</li>
                    <li>
                        <span>Actions</span>
                        <ul>
                            <li><a href="#" title="Approve property">Approve property</a></li>
                            <li><a href="#" title="View facilities">View facilities</a></li>
                            <li>
                                <span>Translation</span>
                                <ul>
                                    <li><a href="#" title="Tiếng Việt">Tiếng Việt</a></li>
                                    <li><a href="#" title="French">French</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <!-- functions.end -->

            </div>
            <!-- panel.end -->
         
        </div>
<script type="text/javascript">
    $(function () {
        $('a#submit_link').click(function () {
            $('form#Submitform').submit();
        });
    });
</script>
<script type="text/javascript">
    $(function () {
        $("#tabs").tabs();
    });
  </script>
 @*  <script type="text/javascript">
       $(document).ready(function () {
           $("a#submit_linkUploadImage").click(function () {
               var hotelId = $('#GetHotelId').val();
               var roomtyid = $('#SelectRoomType').val();
               alert('@Url.Action("UploadImage")');
               $.post({

                   data: $('#uploadfileid').val(),
                   url: '@Url.Action("UploadImage")',
                   done: function (e, data) {
                       // "data.result" will contain the response data
                   },
                   progressall: function (e, data) {
                       var progress = parseInt(data.loaded / data.total * 100, 10);
                       $('#progress .bar').css('width', progress + '%');
                   }
               });
           });
       });
      </script>*@
      <script type="text/javascript">
          $(".Checkbox").click(function () {
              var hotelId = $('#GetHotelId').val();
              var servicesid = $(this).val();
              if ($(this).attr('checked')) {

                  $.get('@Url.Action("UpdateServicesOfHotel")',
                          {
                              hotelid: hotelId, servicesid: servicesid
                          }, function (data) {

                              if (data == "S") {
                                  alert('Thêm dịch vụ cho khách sạn thành công');
                              }
                              else {
                                  alert('Lỗi');
                              }
                          })
              }
              else {
                  $.get('@Url.Action("DeleteServicesOfHotel")',
                          {
                              hotelid: hotelId, servicesid: servicesid
                          }, function (data) {

                              if (data == "S") {
                                  alert('Xóa dịch vụ cho khách sạn thành công');
                              }
                              else {
                                  alert('Lỗi');
                              }
                          })
              }
          });
          
       </script> @*chon roomtype and load image ks*@
             <script type="text/javascript">
                 function LoadImage (roomtypeid) {
                    
                     var hotelId = $('#GetHotelId').val();
//                     var servicesid = $(this).val();
                     $.ajax({
                         type: "GET",
                         url: '@Url.Action("GetImageofRoomType")',
                         data: "hotelId=" + hotelId + "&roomtypeid=" + roomtypeid ,
                         success: function (msg) {
                             document.getElementById('divDocument').innerHTML = msg;
                         }
                     });


                 };
          
       </script>

@*       <script type="text/javascript">
           $(function () {
               $('a#submit_linkUploadImage').click(function () {
                   alert('heree');
                   $('form#SubmitformUploadImage').submit();
               });
           });
</script>*@

@*// test upload image by ajax*@
   <script type="text/javascript">

       $("a#submit_linkUploadImage").click(function () {
           //           var hotelId = $('#GetHotelId').val();
           //           var roomtyid = $('#SelectRoomType').val();
           // set file == null when upload sucess
           
           $("form#SubmitformUploadImage").ajaxForm({ target: "#divDocument" }).submit();
//           document.getElementById('form#SubmitformUploadImage').reset();
       });
          
    </script>

    <script type="text/javascript">


        $().ready(function () {
            $("#deleteImageLink").click(function (e) {
                var selected = "";
                $("input:checkbox[name=checkboxForDelete]:checked").each(function () {
                    //            selected.push($(this).val());
                    selected =   selected + ";" +  $(this).val() ;
                });
                
                var hotelId = $('#GetHotelId').val();
                var roomtyid = $('#SelectRoomType').val();
                $.get('@Url.Action("DeleteImageOfHotel")',
                          {
                              imageStoreId: selected, HotelId: hotelId, roomtypeid: roomtyid
                          }, function (data) {
                              
                                  document.getElementById('divDocument').innerHTML = data;                             
                          })

                //window.location.reload(true);
            });
        });

    </script>

        
